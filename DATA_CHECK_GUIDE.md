# æ•°æ®é›†è´¨é‡æ£€æŸ¥å·¥å…·ä½¿ç”¨æŒ‡å—

## ğŸ“‹ åŠŸèƒ½ç®€ä»‹

`data_check.py` æ˜¯ä¸€ä¸ªç”¨äºæ£€æŸ¥Text-to-Motionæ•°æ®é›†è´¨é‡çš„å·¥å…·ï¼Œå¯ä»¥å¸®åŠ©æ‚¨ï¼š

1. âœ… å¯è§†åŒ–åŠ¨ä½œåºåˆ—ï¼ˆç”Ÿæˆ.gifåŠ¨ç”»ï¼‰
2. âœ… æŸ¥çœ‹æ–‡æœ¬æè¿°ä¸åŠ¨ä½œçš„å¯¹åº”å…³ç³»
3. âœ… æ£€æŸ¥æ•°æ®çš„ç»Ÿè®¡ä¿¡æ¯
4. âœ… ç”ŸæˆHTMLæŠ¥å‘Šæ–¹ä¾¿æŸ¥çœ‹

---

## ğŸ“ æ•°æ®ç›®å½•ç»“æ„

åœ¨ä½¿ç”¨å‰ï¼Œè¯·ç¡®ä¿æ‚¨çš„æ•°æ®æŒ‰ä»¥ä¸‹ç»“æ„ç»„ç»‡ï¼š

```
Text-to-Motion-Generation/
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ pose/                    # åŠ¨ä½œæ•°æ®ç›®å½•
â”‚   â”‚   â”œâ”€â”€ pose_0001.mat       # åŒ…å« 'pred_vector' å­—æ®µ
â”‚   â”‚   â”œâ”€â”€ pose_0002.mat
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚
â”‚   â””â”€â”€ script/                  # æ–‡æœ¬æè¿°ç›®å½•
â”‚       â”œâ”€â”€ script_0001.txt     # å¯åŒ…å«å¤šè¡Œæè¿°
â”‚       â”œâ”€â”€ script_0002.txt
â”‚       â””â”€â”€ ...
â”‚
â””â”€â”€ data_check.py
```

### æ•°æ®æ ¼å¼è¦æ±‚

**Poseæ–‡ä»¶ (.matæ ¼å¼)**
- æ–‡ä»¶å: `pose_XXXX.mat` (XXXXæ˜¯4ä½æ•°å­—ID)
- å¿…é¡»åŒ…å«å­—æ®µ: `pred_vector` (æˆ– `pose_vector`, `action_vector`)
- æ•°æ®ç»´åº¦: `[dim_action, action_steps]` (é€šå¸¸æ˜¯ `[24, 32]`)

**Scriptæ–‡ä»¶ (.txtæ ¼å¼)**
- æ–‡ä»¶å: `script_XXXX.txt` (XXXXä¸å¯¹åº”çš„poseæ–‡ä»¶IDç›¸åŒ)
- æ¯è¡Œä¸€ä¸ªæ–‡æœ¬æè¿°
- ç¤ºä¾‹å†…å®¹:
  ```
  a woman is dancing
  a person moves gracefully
  ```

---

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### 1. éšæœºæ£€æŸ¥æ¨¡å¼ï¼ˆæ¨èç”¨äºå¿«é€Ÿé¢„è§ˆï¼‰

éšæœºé€‰æ‹©5ä¸ªæ ·æœ¬è¿›è¡Œæ£€æŸ¥ï¼š

```bash
python data_check.py --mode random --num_samples 5
```

è‡ªå®šä¹‰éšæœºæ ·æœ¬æ•°é‡ï¼š

```bash
python data_check.py --mode random --num_samples 10
```

### 2. æ£€æŸ¥æ‰€æœ‰æ ·æœ¬

æ£€æŸ¥æ‰€æœ‰æ•°æ®é›†ï¼š

```bash
python data_check.py --mode all
```

é™åˆ¶æœ€å¤šæ£€æŸ¥çš„æ ·æœ¬æ•°ï¼š

```bash
python data_check.py --mode all --max_samples 20
```

### 3. æ£€æŸ¥ç‰¹å®šæ ·æœ¬

æ£€æŸ¥IDä¸º0001çš„æ ·æœ¬ï¼š

```bash
python data_check.py --mode single --sample_id 0001
```

æ£€æŸ¥IDä¸º0042çš„æ ·æœ¬ï¼š

```bash
python data_check.py --mode single --sample_id 0042
```

### 4. è‡ªå®šä¹‰æ•°æ®è·¯å¾„

å¦‚æœæ‚¨çš„æ•°æ®åœ¨ä¸åŒä½ç½®ï¼š

```bash
python data_check.py \
    --mode random \
    --num_samples 5 \
    --pose_dir /path/to/pose \
    --script_dir /path/to/script \
    --output_dir /path/to/output
```

---

## ğŸ“Š è¾“å‡ºç»“æœ

è¿è¡Œåï¼Œå·¥å…·ä¼šç”Ÿæˆä»¥ä¸‹å†…å®¹ï¼š

### ç›®å½•ç»“æ„

```
data_check_results/
â”œâ”€â”€ summary_report.html           # æ±‡æ€»æŠ¥å‘Šï¼ˆåœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ï¼‰
â”‚
â”œâ”€â”€ sample_0001/                  # æ ·æœ¬0001çš„ç»“æœ
â”‚   â”œâ”€â”€ 0001_1_a_woman_is_dancing_8frames.png
â”‚   â”œâ”€â”€ 0001_1_a_woman_is_dancing_animation.gif
â”‚   â”œâ”€â”€ 0001_1_a_woman_is_dancing_32frames_grid.png
â”‚   â””â”€â”€ 0001_1_a_woman_is_dancing_action.npy
â”‚
â”œâ”€â”€ sample_0002/                  # æ ·æœ¬0002çš„ç»“æœ
â”‚   â””â”€â”€ ...
â”‚
â””â”€â”€ ...
```

### æ¯ä¸ªæ ·æœ¬ç”Ÿæˆçš„æ–‡ä»¶

å¯¹äºæ¯ä¸ªæ–‡æœ¬-åŠ¨ä½œå¯¹ï¼Œä¼šç”Ÿæˆ4ä¸ªæ–‡ä»¶ï¼š

1. **`*_8frames.png`** - 8ä¸ªå…³é”®å¸§çš„å½©è‰²éª¨æ¶å›¾
2. **`*_animation.gif`** - 32å¸§å®Œæ•´åŠ¨ç”»ï¼ˆæ¨èæŸ¥çœ‹ï¼ï¼‰
3. **`*_32frames_grid.png`** - æ‰€æœ‰32å¸§çš„ç½‘æ ¼å›¾
4. **`*_action.npy`** - åŸå§‹åŠ¨ä½œæ•°æ®ï¼ˆå¯ç”¨äºåç»­åˆ†æï¼‰

### HTMLæŠ¥å‘Š

æ‰“å¼€ `summary_report.html` å¯ä»¥åœ¨æµè§ˆå™¨ä¸­æŸ¥çœ‹ï¼š
- æ‰€æœ‰æ ·æœ¬çš„æ±‡æ€»ä¿¡æ¯
- æ¯ä¸ªæ ·æœ¬çš„æ–‡æœ¬æè¿°
- åŠ¨ä½œæ•°æ®çš„ç»Ÿè®¡ä¿¡æ¯ï¼ˆå‡å€¼ã€æ ‡å‡†å·®ã€èŒƒå›´ï¼‰
- å†…åµŒçš„GIFåŠ¨ç”»å’Œå…³é”®å¸§å›¾ç‰‡

---

## ğŸ¨ å¯è§†åŒ–è¯´æ˜

ç”Ÿæˆçš„éª¨æ¶å¯è§†åŒ–ä½¿ç”¨ä»¥ä¸‹é¢œè‰²ç¼–ç ï¼š

- ğŸ”´ **çº¢è‰²**: å¤´éƒ¨å…³é”®ç‚¹ (joint 7)
- ğŸŸ¢ **ç»¿è‰²**: æ‰‹è‡‚å’Œæ‰‹éƒ¨å…³é”®ç‚¹ (joints 1-6)
- ğŸ”µ **è“è‰²**: é¢ˆéƒ¨å…³é”®ç‚¹ (joint 0, åŸºå‡†ç‚¹)

---

## ğŸ” è´¨é‡æ£€æŸ¥è¦ç‚¹

ä½¿ç”¨æ­¤å·¥å…·æ—¶ï¼Œè¯·æ³¨æ„æ£€æŸ¥ï¼š

### 1. åŠ¨ä½œæµç•…åº¦
- æ’­æ”¾ `*_animation.gif` æŸ¥çœ‹åŠ¨ä½œæ˜¯å¦æµç•…
- æ£€æŸ¥æ˜¯å¦æœ‰çªå˜æˆ–ä¸è‡ªç„¶çš„è·³è·ƒ

### 2. æ–‡æœ¬-åŠ¨ä½œåŒ¹é…åº¦
- æ–‡æœ¬æè¿°æ˜¯å¦ä¸åŠ¨ä½œä¸€è‡´
- ä¾‹å¦‚ï¼š"a person is waving" åº”è¯¥æœ‰æŒ¥æ‰‹åŠ¨ä½œ

### 3. æ•°æ®ç»Ÿè®¡ä¿¡æ¯
- **å‡å€¼** åº”è¯¥åœ¨åˆç†èŒƒå›´å†…ï¼ˆé€šå¸¸æ¥è¿‘0ï¼‰
- **æ ‡å‡†å·®** ä¸åº”è¿‡å¤§æˆ–è¿‡å°
- **èŒƒå›´** æ£€æŸ¥æ˜¯å¦æœ‰å¼‚å¸¸å€¼

### 4. æ•°æ®å®Œæ•´æ€§
- æ£€æŸ¥poseæ–‡ä»¶å’Œscriptæ–‡ä»¶æ˜¯å¦ä¸€ä¸€å¯¹åº”
- æ£€æŸ¥æ•°æ®ç»´åº¦æ˜¯å¦æ­£ç¡® `[24, 32]`

---

## ğŸ’¡ å¸¸è§é—®é¢˜

### Q1: æ‰¾ä¸åˆ°poseæ–‡ä»¶æˆ–scriptæ–‡ä»¶
**A**: è¯·ç¡®ä¿ï¼š
- æ•°æ®ç›®å½•è·¯å¾„æ­£ç¡®
- æ–‡ä»¶å‘½åç¬¦åˆè§„èŒƒ (pose_XXXX.mat, script_XXXX.txt)
- æ–‡ä»¶ç¡®å®å­˜åœ¨

ä½¿ç”¨ `--pose_dir` å’Œ `--script_dir` å‚æ•°æŒ‡å®šæ­£ç¡®è·¯å¾„ã€‚

### Q2: æç¤ºæ‰¾ä¸åˆ° 'pred_vector' å­—æ®µ
**A**: å·¥å…·ä¼šå°è¯•å…¶ä»–å¸¸è§å­—æ®µåï¼š
- `pose_vector`
- `action_vector`
- `pose`
- `action`

å¦‚æœæ‚¨çš„å­—æ®µåä¸åŒï¼Œè¯·ä¿®æ”¹ `data_check.py` ä¸­çš„ `load_pose()` å‡½æ•°ã€‚

### Q3: ç”Ÿæˆçš„GIFæ–‡ä»¶å¾ˆå¤§
**A**: è¿™æ˜¯æ­£å¸¸çš„ï¼Œ32å¸§çš„3DåŠ¨ç”»é€šå¸¸éœ€è¦å‡ ç™¾KBåˆ°å‡ MBã€‚
å¦‚æœéœ€è¦å‹ç¼©ï¼Œå¯ä»¥ï¼š
- é™ä½GIFçš„DPIï¼ˆä¿®æ”¹ä»£ç ä¸­çš„ `dpi=100` å‚æ•°ï¼‰
- å‡å°‘å¸§æ•°ï¼ˆä¿®æ”¹å¯è§†åŒ–å‡½æ•°ï¼‰

### Q4: æƒ³è¦æ£€æŸ¥metadata.npzæ–‡ä»¶
**A**: å¦‚æœæ‚¨å·²ç»ç”Ÿæˆäº† `metadata.npz`ï¼Œå¯ä»¥æ·»åŠ ä¸€ä¸ªç®€å•çš„è„šæœ¬è¯»å–å®ƒï¼š

```python
import numpy as np

# åŠ è½½metadata
data = np.load('./data/metadata.npz')
train_action = data['arr_0']      # [num_data, 24, 32]
train_script = data['arr_1']      # [num_data, 300, 30]
train_length = data['arr_2']      # [num_data]
sentence_steps = data['arr_3']    # int

print(f"åŠ¨ä½œæ•°æ®: {train_action.shape}")
print(f"æ–‡æœ¬æ•°æ®: {train_script.shape}")
print(f"æ ·æœ¬æ•°é‡: {len(train_action)}")
```

---

## ğŸ› ï¸ é«˜çº§ç”¨æ³•

### åˆ›å»ºè‡ªå®šä¹‰æ£€æŸ¥è„šæœ¬

æ‚¨å¯ä»¥å¯¼å…¥ `DatasetChecker` ç±»åœ¨è‡ªå·±çš„è„šæœ¬ä¸­ä½¿ç”¨ï¼š

```python
from data_check import DatasetChecker

# åˆ›å»ºæ£€æŸ¥å™¨
checker = DatasetChecker(
    pose_dir='./data/pose',
    script_dir='./data/script',
    output_dir='./my_check_results'
)

# æ£€æŸ¥ç‰¹å®šæ ·æœ¬
results = checker.check_single_sample('0001')

# æ‰¹é‡æ£€æŸ¥
all_results = checker.check_all_samples(max_samples=10)
```

### ä¿®æ”¹å¯è§†åŒ–æ ·å¼

å¯è§†åŒ–åŠŸèƒ½ä½¿ç”¨ `model/seq2seq_enhanced_visualization.py`ã€‚
æ‚¨å¯ä»¥ä¿®æ”¹è¯¥æ–‡ä»¶æ¥ï¼š
- æ”¹å˜éª¨æ¶é¢œè‰²
- è°ƒæ•´è§†è§’ (ä¿®æ”¹ `view_init()` å‚æ•°)
- æ”¹å˜GIFå¸§ç‡ (ä¿®æ”¹ `fps` å‚æ•°)

---

## ğŸ“ ç¤ºä¾‹å·¥ä½œæµç¨‹

### å…¸å‹çš„æ•°æ®æ£€æŸ¥æµç¨‹ï¼š

```bash
# 1. é¦–å…ˆéšæœºæ£€æŸ¥5ä¸ªæ ·æœ¬ï¼Œå¿«é€Ÿäº†è§£æ•°æ®è´¨é‡
python data_check.py --mode random --num_samples 5

# 2. æ‰“å¼€ data_check_results/summary_report.html æŸ¥çœ‹
# 3. å¦‚æœå‘ç°é—®é¢˜ï¼Œæ£€æŸ¥ç‰¹å®šæ ·æœ¬
python data_check.py --mode single --sample_id 0042

# 4. å¦‚æœæ•°æ®è´¨é‡è‰¯å¥½ï¼Œæ£€æŸ¥æ›´å¤šæ ·æœ¬
python data_check.py --mode random --num_samples 20

# 5. æœ€ç»ˆæ£€æŸ¥æ‰€æœ‰æ•°æ®ï¼ˆå¯èƒ½éœ€è¦è¾ƒé•¿æ—¶é—´ï¼‰
python data_check.py --mode all --max_samples 100
```

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. æ•°æ®æ ¼å¼æ˜¯å¦ç¬¦åˆè¦æ±‚
2. Pythonä¾èµ–æ˜¯å¦å®Œæ•´å®‰è£… (numpy, scipy, matplotlib, tqdm)
3. æ§åˆ¶å°é”™è¯¯ä¿¡æ¯

---

## ğŸ¯ ä¸‹ä¸€æ­¥

æ•°æ®æ£€æŸ¥å®Œæˆåï¼š

1. âœ… å¦‚æœæ•°æ®è´¨é‡è‰¯å¥½ â†’ ç»§ç»­è¿›è¡Œæ¨¡å‹è®­ç»ƒ
2. âš ï¸ å¦‚æœå‘ç°é—®é¢˜ â†’ ä¿®æ­£æ•°æ®æˆ–è¿‡æ»¤ä½è´¨é‡æ ·æœ¬
3. ğŸ“Š ä¿å­˜æ£€æŸ¥æŠ¥å‘Š â†’ ç”¨äºæ–‡æ¡£è®°å½•

ç¥æ‚¨æ•°æ®æ£€æŸ¥é¡ºåˆ©ï¼ğŸš€
